## 快速开始
下载[星夜引擎的发行版]()<br/><br/>
解压文件,打开userData文件夹中的config.txt,配置你的游戏信息
```
Game_name:咸鱼生活 //你的游戏名称,会显示在浏览器的标签页上
Game_key:996icu_xco //如果在同一域名同一目录下有多个游戏,则需要配置此项,不理解则请忽略
Title_img:Title2.png; //起始页的背景，文件放在/image 文件夹
Title_bgm:夏影.mp3; //起始页的背景音乐，文件放在/audio 文件夹
```
复制以下内容到同一文件夹下的script.txt
```
----
@显示对话 名称:咸鱼 文字:"Hello World!"
@更改背景 文件:saltlife.jpg
@放置立绘 名称:咸鱼 文件:saltfish\fish.jpg x:640 y:640
----
```
运行WebGal.exe,会自动打开浏览器(如果没有请手动[打开](localhost:8888))<br/>
点击"开始游戏",显示如下:~~一张图片,之后截~~

## 需要了解的概念
#### 命令:
参考接下来的"命令"部分,操作某个元素(如音乐,图片等)的指令就称为命令
#### 幕:
一次点击被称为一幕,在一幕中可以有任意多个命令,在玩家进行点击操作后,对应幕中的命令将会执行<br/>
如果第二次点击时命令还未执行完毕,则会将命令全部执行而不会进入下一幕
#### 删除线:
你可能会在文档中看到不少删除线,这不代表删除了,而是代表**还没做**<br/>
之后找到更好的方式会修改掉
## 剧本基本格式
星夜引擎的剧本格式非常简单,如下所示
```ts
----
@命令名称 命令参数:参数值 命令参数:参数值 //注释
----
@命令名称 命令参数:参数值 命令参数:参数值
----
```
`----`用于分割不同的幕<br/>
`//`用于注释,在它之后的内容会被引擎忽略<br/>
举个实际栗子
```ts
----
@更改背景 文件:saltlife.jpg
@放置立绘 名称:咸鱼 文件:saltfish\fish.jpg x:640 y:640
----
@显示对话 名称:咸鱼 文字:"啊这...\n摸了!" //完工,睡觉
----
```
`saltfish\fish.jpg`代表引擎目录下 saltfish文件夹中的fish.jpg<br/>
`""`代表一段连续文本,如果文本含有空格或[容易引起歧义的时候](#引号的使用场景)则需要用""包裹<br/>
在文本中使用`\n`来换行,如果想在`""`包裹的文本中使用`"`,则需要写成`\"`<br/><br/>
命令参数的顺序是随意的,所以这样也是正确的(...表示省略的上下文)<br/>
不过,推荐使用一个固定的参数顺序
```
...
@放置立绘 文件:saltfish\fish.jpg x:640 名称:咸鱼 y:640
...
```
一行只能有一条命令,~~或用 ; 分割~~<br/>
## 命令参数
星夜引擎提供的命令具有统一的参数名称,所有命令参数及其含义如下所示<br/>
接下来的[命令](#命令-2)只会提到这些参数,你可以先看一看这些参数,也可以直接进入[命令](#命令-2)的学习
### 文本
一段文本,这个参数只在[对话和语音](#对话和语音)命令中出现<br/>
这个参数是一个文本值
### 名称
给当前命令操作的元素命名,如[放置立绘](#放置立绘)<br/>
也可能直接显示在游戏上,[显示对话](#显示对话)<br/>
这个参数是一个文本值
### 目标
在一个命令为元素命名后,使用这个参数来明确"我要操作目标元素"<br/>
这个参数是一个文本值
### 文件
告诉命令要使用哪个文件,或者,如果你想更详细的区分文件类型,你也可以使用<br/>
`音频:xxx` `视频:xxx` `图片:xxx` 它们完全等价于 `文件:xxx`<br/>
但它们也只是起到一个标注作用,并不会去校验这个文件到底是什么类型<br/>
~~或许以后会更新校验功能,并在IDE提示中发挥作用~~<br/>
这个参数是一个文本值
### 坐标
相对于游戏画面左上角的坐标,在如[放置立绘](#放置立绘)等图像操作的命令中应用<br/>
包含 `x:xxx` 和 `y:xxx` 两个<br/>
这个参数是一个数字
### 时间
持续时间,淡入时间,等待时间等等,都属于这个参数<br/>
这个参数的格式如 `时间:5s` ,代表5秒<br/>
如果需要一分钟以上的时长比如一分三十秒,则需要手动换算为90s<br/>
不可省略`s`<br/>
这个参数是一个文本值
### 缓动
缓动函数是一种算法,用于设置淡入淡出等效果<br/>
可用的缓动函数请参考[缓动函数速查表](https://www.xuanfengge.com/easeing/easeing/)<br/>
你需要填入的值是链接展示的缓动函数之一,如`easeInSine`<br/>
~~暂时不支持直接使用贝塞尔曲线~~<br/>
这个参数是一个文本值
## 命令
### 对话和语音
#### 命令名称`@对话`
| 参数        | 功能         |
| ------------- |:-------------:|
| 文本      | 在对话框中展示文本        |
| 名称      | 在对话框中展示人物名称     |
| 文件      | 播放人物语音             |
一幕中只允许有一条对话<br/>
或参考[特殊情况](#使用等待处理特殊情况)<br/>
使用演示
```ts
@对话 名称:鸽子 文字:咕咕咕 文件:咕.mp3
```
其中`名称`和`文件`是可空参数,所以你也可以这样写
```ts
@对话 文字:咕咕咕
```
如果你省略了名称参数,它将继承前一幕的名称<br/>
如果你想将对话框中的人物名称设置为空,则需要这样写: `名称:""`<br/>
之后不再重复演示可空参数的用法<br/>
`文件`参数的其他写法[参考](#文件)
### 更改背景
### 放置立绘
### 关闭立绘
### 移动图片元素
### 抖动图片元素
### 播放背景音乐
### 播放环境音
### 播放视频
### 跳转选项与跳转标识
### 等待
#### 使用等待处理特殊情况
## 拆分剧本
在script.txt的第一行中标识脚本顺序,举例
```haskell
咕咕咕.txt => gugu.txt => 场景3.txt
=> 场景4.txt => 场景5.txt
```
可以使用空格使格式更整齐,也可以不使用空格<br/>
之后不要在script.txt中写其他字符了,否则可能会引发错误
## 使用IDE提示
只需要安装[VSCode](),并在VSCode中安装[插件](),即可使用提示功能<br/>
在剧本中输入@即可获得所有命令的提示,~~暂时不支持宏命令~~,用↑↓键选择一个命令,按Enter键输入<br/>
这时光标会自动移动到第一个参数处并给出可能的提示,输入参数的值,按Tab键即可切换到下一个参数<br/>
如果你同时有其他代码编写需求,可以把剧本的格式从.txt改为.sne,并在插件中设置"代码提示"<br/>
这个插件还提供一定的语法高亮和错误检查功能<br/><br/>
另外,VSCode本身也支持一些方便的快捷键,具体可以查找[百度](https://www.baidu.com/s?wd=vscode%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE)<br/>
猜测可能常用以下快捷键
```
向上/向下移动行 Alt+ ↑ / ↓
向上/向下复制行 Shift+Alt + ↓ / ↑
在文件内查找替换 Ctrl + F
```

## 命令调用链

## 别名(宏)
在userData文件夹中的macro.txt配置宏,你应该会看到很多已经配置好的宏<br/>
新建一个空白行以编写你自己的宏
### 配置与使用
宏在剧本中有非常丰富的应用场景,星夜引擎的宏定义方式如下
```ts
结果字符串 => 原字符串 //宏支持注释
烤{str}串 => 羊肉{str}串 //宏支持插值表达式
```
一行定义一个宏,如果宏中需要换行使用`\n`<br/>
`=>`两侧的空格是必须的<br/>
~~虽然 => 的语法限制可以避免大多数错误,但是仍然不允许在宏中定义一个 => ,用字符串包裹宏会产生更多问题,还在研究处理中~~<br/>
以上两个宏应用在剧本中会产生这样的效果
```ts
//你看到的剧本
@对话 文字:结果字符串
@对话 文字:烤白薯串
//编译结果
@对话 文字:原字符串
@对话 文字:羊肉白薯串
```
如果宏要操作一个被`""`包裹的文本,需要使用插值语法`{{}}`
```wiki
@对话 文字:"结果字符串{{结果字符串}}"
```
这段剧本的编译结果为
```
@对话 文字:"结果字符串原字符串"
```
宏在"[宏在引擎中的应用](#宏在引擎中的应用)"中还有丰富的使用实例
### 使用英文命令和英文参数
只需在macro.txt中删除`//中文转换`下的所有预定义宏即可,如果你已经对宏有足够的了解,也可以按需删除
### 使用其他风格的命令语法
星夜引擎提供了一些其他风格的命令语法,要注意的是,这些语法风格并不能被[代码提示插件](#使用IDE提示)很好的识别<br/>
下载对应的宏定义并复制到macro.txt即可使用
#### WebGAL风格
格式:`command:content -parameter1 -parameter2 ......;`<br/>
这个风格不支持任意的参数顺序<br/>
### 宏在引擎中的应用
::: tip 注意
这是一个扩展内容
:::
## 引号的使用场景
