(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{343:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("剧本是基于 JavaScript 的，但无需担心 —— 即使没有相关基础，只需花几分钟学习"),s("a",{attrs:{href:"./code"}},[t._v("基础语法")]),t._v("即可轻松上手剧本编写。")])]),t._v(" "),s("p",[t._v("游戏的剧本应该放置于 "),s("code",[t._v("scenario")]),t._v(" 文件夹中，游戏的资源应该放置于 "),s("code",[t._v("public/static")]),t._v(" 文件夹中。")]),t._v(" "),s("h2",{attrs:{id:"命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[t._v("#")]),t._v(" 命令")]),t._v(" "),s("p",[t._v("使用命令操作舞台中的元素，基本格式是："),s("code",[t._v("模式.命令名称(命令参数)")])]),t._v(" "),s("p",[s("code",[t._v("模式")]),t._v(" 表示命令的执行方式，分为以下两种：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("$")]),t._v(" 表示执行本条命令并立即继续向下执行")]),t._v(" "),s("li",[s("code",[t._v("$$")]),t._v(" 表示等待本条命令完成再继续向下执行")])]),t._v(" "),s("p",[t._v("不同命令支持的模式不同，有些可以选择两种模式之一，有些只能使用其中一种模式。")]),t._v(" "),s("h2",{attrs:{id:"对话"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对话"}},[t._v("#")]),t._v(" 对话")]),t._v(" "),s("p",[t._v("对话是视觉小说中最高频的结构，所以拥有特殊简化的语法。")]),t._v(" "),s("p",[t._v("一条对话由三个部分组成，"),s("code",[t._v('角色`对话文本` + "对话配音"')]),t._v("，如果没有配音文件，可以省略配音部分。")]),t._v(" "),s("p",[t._v("使用"),s("code",[t._v("$character")]),t._v("创建角色，下面的示例使用常量"),s("code",[t._v("noi")]),t._v("来保存这个角色，之后这个角色的对话就都可以使用"),s("code",[t._v("noi")]),t._v("简写。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" noi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$character")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"诺瓦"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……我将踏上一段愉快的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/noi0001.flac'")]),t._v("\n")])])]),s("p",[t._v("对话默认以 "),s("code",[t._v("$")]),t._v(" 模式运行，可以通过在对话前添加 "),s("code",[t._v("$:")]),t._v(" 或 "),s("code",[t._v("$$:")]),t._v("，指定对话的执行模式。")]),t._v(" "),s("h2",{attrs:{id:"幕"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#幕"}},[t._v("#")]),t._v(" 幕")]),t._v(" "),s("p",[t._v("幕是剧情的基本单元，由若干条命令组成，幕中的命令执行完毕后，将等待用户点击进入下一幕。")]),t._v(" "),s("p",[t._v("对话如果没有指定执行模式，将自动划分出新的一幕；使用 "),s("code",[t._v("$action")]),t._v(" 可以手动划分出新的一幕。")]),t._v(" "),s("p",[t._v("在划分第 1 幕之前，称为第 0 幕，可以用于设置舞台的初始状态。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("命令")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第0幕")]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……我将踏上一段愉快的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第1幕")]),t._v("\n$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("命令")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第1幕")]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……与你一同的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第2幕")]),t._v("\n$action "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第3幕")]),t._v("\n$"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("noi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("无论何时……都与你一起……")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第3幕")]),t._v("\n")])])]),s("h2",{attrs:{id:"剧本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#剧本"}},[t._v("#")]),t._v(" 剧本")]),t._v(" "),s("p",[t._v("剧本文件的命名格式为 "),s("code",[t._v("*.scenario.(js|ts|jsx|tsx)")]),t._v("，例如 "),s("code",[t._v("story.scenario.ts")]),t._v("。")]),t._v(" "),s("p",[s("code",[t._v(".scenario")]),t._v(" 表示这是一个剧本文件，"),s("code",[t._v(".ts")]),t._v(" 后缀表示所使用的 JavaScript 方言。")]),t._v(" "),s("p",[t._v("可以在剧本中使用除了 "),s("code",[t._v("export")]),t._v(" 外的全部 JavaScript 功能，比如变量、分支和循环。")]),t._v(" "),s("p",[t._v("同时也可以选择启用某种方言特性，比如通过 TypeScript 使用类型标注。")]),t._v(" "),s("p",[t._v("剧情将从入口文件 "),s("code",[t._v("scenario/index.scenario.(mjs|js|mts|ts|jsx|tsx)")]),t._v(" 开始。")]),t._v(" "),s("h3",{attrs:{id:"拆分剧本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#拆分剧本"}},[t._v("#")]),t._v(" 拆分剧本")]),t._v(" "),s("p",[t._v("在剧本中使用 "),s("code",[t._v("$include")]),t._v(" 将指定剧本的内容嵌入。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// scenario/index.scenario.tsx")]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……我将踏上一段愉快的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第1幕")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$include")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./example.scenario.tsx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("命令")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第2幕")]),t._v("\n")])])]),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// scenario/example.scenario.tsx")]),t._v("\n$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("命令")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第1幕")]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……与你一同的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第2幕")]),t._v("\n")])])]),s("h3",{attrs:{id:"调试剧本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调试剧本"}},[t._v("#")]),t._v(" 调试剧本")]),t._v(" "),s("p",[t._v("在剧本中使用 "),s("code",[t._v("$debugger")]),t._v(" 让剧情从指定位置开始。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v("noi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……我将踏上一段愉快的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("……与你一同的旅程。")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n$"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("debugger")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 剧情将从这里开始")]),t._v("\nnoi"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("无论何时……都与你一起……")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n")])])]),s("h3",{attrs:{id:"剧情分支"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#剧情分支"}},[t._v("#")]),t._v(" 剧情分支")]),t._v(" "),s("p",[t._v("在剧本中使用"),s("a",{attrs:{href:"./code#%E5%88%86%E6%94%AF"}},[t._v("分支语句")]),t._v("实现剧情分支。")]),t._v(" "),s("p",[t._v("下面的示例通过"),s("a",{attrs:{href:"./api#%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9"}},[t._v("用户选择")]),t._v("命令获取用户选择的选项，通过其他命令可以获取用户提供的更多信息。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" chosen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" $$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("用户选择")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" 标识符"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*そのまま渡す'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 描述文本"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'直接给她'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" 标识符"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*振ってから渡す'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 描述文本"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'晃晃再给她'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chosen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*そのまま渡す'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 选择'直接给她'的分支剧情 */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chosen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*振ってから渡す'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 选择'晃晃再给她'的分支剧情 */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"系统变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#系统变量"}},[t._v("#")]),t._v(" 系统变量")]),t._v(" "),s("p",[t._v("在剧本中使用 "),s("code",[t._v("$store")]),t._v(" 获取包括设置，存档在内的全部游戏数据。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v("system"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("当前游戏名称为：")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("$store"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("system"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n")])])]),s("p",[t._v("在剧本中使用 "),s("code",[t._v("$context")]),t._v(" 获取游戏实例当前的运行时数据。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v("system"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("当前游戏状态为：")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("$context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n")])])]),s("h2",{attrs:{id:"参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[t._v("#")]),t._v(" 参数")]),t._v(" "),s("p",[t._v("命令有一些常见的参数命名,以下说明它们代表的含义。")]),t._v(" "),s("h3",{attrs:{id:"标识符"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#标识符"}},[t._v("#")]),t._v(" 标识符")]),t._v(" "),s("p",[t._v("标识符，或者说 ID，用于后续操作时引用这个元素。")]),t._v(" "),s("h3",{attrs:{id:"作用目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#作用目标"}},[t._v("#")]),t._v(" 作用目标")]),t._v(" "),s("p",[t._v("操作元素的命令需要这个参数，填入目标的标识符。")]),t._v(" "),s("h3",{attrs:{id:"持续时间"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#持续时间"}},[t._v("#")]),t._v(" 持续时间")]),t._v(" "),s("p",[t._v("持续时间参数的单位为毫秒，具体作用参看命令说明。")]),t._v(" "),s("h3",{attrs:{id:"资源路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#资源路径"}},[t._v("#")]),t._v(" 资源路径")]),t._v(" "),s("p",[s("code",[t._v("public/static")]),t._v(" 文件夹中的资源，填写时由 "),s("code",[t._v("/")]),t._v(" 开头。")]),t._v(" "),s("p",[t._v("比如 "),s("code",[t._v("public/static/咕.mp3")]),t._v(" ，填写为 "),s("code",[t._v("/咕.mp3")]),t._v(" 。")])])}),[],!1,null,null,null);s.default=e.exports}}]);